
# <center> Модель прогнозирования стоимости жилья для агентства недвижимости </center>

## Оглавление
1. [Описание проекта](https://github.com/Agent-66/Real_Estate_Forecast/blob/main/README.md#Описание-проекта)
2. [Описание данных](https://github.com/Agent-66/Real_Estate_Forecast/blob/main/README.md#Описание-данных)
3. [Зависимости](https://github.com/Agent-66/Real_Estate_Forecast/blob/main/README.md#Зависимости)
4. [Установка проекта](https://github.com/Agent-66/Real_Estate_Forecast/blob/main/README.md#Установка-проекта)
5. [Использование проекта](https://github.com/Agent-66/Real_Estate_Forecast/blob/main/README.md#Использование-проекта)
6. [Авторы](https://github.com/Agent-66/Real_Estate_Forecast/blob/main/README.md#Авторы)
7. [Выводы](https://github.com/Agent-66/Real_Estate_Forecast/blob/main/README.md#Выводы)

## Описание проекта

Агентство недвижимости столкнулось с проблемой — риелторы тратят слишком много времени на сортировку объявлений и поиск выгодных предложений. Поэтому скорость их реакции и качество анализа не дотягивают до уровня конкурентов. Это сказывается на финансовых показателях агентства. Агентству нужно разработать модель машинного обучения, которая поможет обрабатывать объявления и увеличит число сделок и прибыль.

Цель проекта: разработать ML-модель, которая, должна предсказывать цену объекта недвижимости на основе имеющихся в датасете данных.

Для этого предстоит работа с датасетом, в котором содержатся сведения о 377 185 объектах недвижимости в США.

Задачи:

1. Провести разведывательный анализ и очистку исходных данных.
2. Выделить наиболее значимые факторы, влияющие на стоимость недвижимости.
3. Построить модель для прогнозирования стоимости недвижимости.
4. Разработать небольшой веб-сервис, на вход которому поступают данные о некоторой выставленной на продажу недвижимости, а сервис прогнозирует его стоимость.

## Описание данных

Исходные данные содержатся в файле data.csv

Датасет содержит 18 полей со следующей информацией:

* status — статус продажи;
* private pool и PrivatePool — наличие собственного бассейна;
* propertyType — тип объекта недвижимости;
* street — адрес объекта;
* baths — количество ванных комнат;
* homeFacts — сведения о строительстве объекта (содержит несколько типов сведений, влияющих на оценку объекта);
* fireplace — наличие камина;
* city — город;
* schools — сведения о школах в районе;
* sqft — площадь в футах;
* zipcode — почтовый индекс;
* beds — количество спален;
* state — штат;
* stories — количество этажей;
* mls-id и MlsId — идентификатор MLS (Multiple Listing Service, система мультилистинга);
* target — цена объекта недвижимости (целевой признак, который необходимо спрогнозировать)

Структура проекта:

[data](./data/) - директория с датасетами для проекта
[web_app](./web_app/) - директория с файлами веб-сервиса для для тестирования разработанной ML-модели 
[real_estate_forecast_part_1.ipynb](./real_estate_forecast_part_1.ipynb) - jupyter-ноутбук, содержащий основной код проекта (1-я часть - предобработка и анализ данных)
[real_estate_forecast_part_2.ipynb](./real_estate_forecast_part_2.ipynb) - jupyter-ноутбук, содержащий основной код проекта (2-я часть - кодирование данных, моделирование)
[coded_features.ipynb](./coded_features.ipynb) - jupyter-ноутбук, содержащий варианты кодировки данных, которые были протестированы в ходе работы
[requirements.txt](./requirements.txt) - файл со списком внешних зависимостей и их версий 

## Зависимости

Python (3.10.12):
* catboost==1.2
* category-encoders==2.6.0
* Flask==3.0.0
* matplotlib==3.6.2
* matplotlib-inline==0.1.6
* numpy==1.23.5
* optuna==3.2.0
* pandas==1.5.2
* scipy==1.9.3
* seaborn==0.12.2
* sklearn==1.2.2

## Установка проекта

```
git clone https://github.com/Agent-66/Real_Estate_Forecast
```
Архив с исходным датасетом (~48 Mb) нужно скачать отдельно и распаковать в директорию ./data.

Ссылка на датасет:
* [Google Drive](https://drive.google.com/file/d/1GeglODnyOSqErb5Ei5_93PdjatJb0laM/view?usp=sharing) 

## Использование проекта

Вся информация о работе представлена в jupyter-ноутбуках:
- real_estate_forecast_part_1.ipynb;
- real_estate_forecast_part_2.ipynb.

Описание работы веб-сервиса для тестирования ML-модели находится в файле [readme.md](./web_app/readme.md).

## Авторы

* [Andrey Razin (Agent-66)](https://github.com/Agent-66)

## Выводы

В процессе работы был проведен первичный анализ предоставленных данных: структура таблицы, типы и формат данных, проведена работа с пропусками в данных, проверка на аномальные значения, поиск дублей.

На этапе проектирования признаков произведен глубокий анализ строковых данных. Из них выделены значимые признаки, преобразованы в подходящий для модели формат. Произведено кодирование категориальных признаков. Исходные столбцы и неинформативные признаки были удалены из датасета.

На этапе отбора признаков проанализированы их взимосвязи между собой, выполнены проверки на наличие корреляции и мультиколлинеарности. Ряд признаков исключен из финального набора данных. По оставшимся признакам сделана оценка о важности их для построения модели.

На основе полученных данных были обучены ML модели разных типов, произведен подбор оптимальных гиперпараметров для выбранных моделей. Выполнен сравнительный анализ эффективности алгоритмов по заранее определенным метрикам.

На основе самой эффективной модели был разработан веб-сервис, на вход которому поступают данные о некоторой выставленной на продажу недвижимости, а сервис прогнозирует его стоимость.

:arrow_up_small: [к оглавлению](https://github.com/Agent-66/Real_Estate_Forecast/blob/main/README.md#Оглавление)



